<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Library API · Sunny documentation</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Sunny documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Sunny documentation</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../quick-start/">Quick Start</a></li><li class="is-active"><a class="tocitem" href>Library API</a><ul class="internal"><li><a class="tocitem" href="#Crystal-definition"><span>Crystal definition</span></a></li><li><a class="tocitem" href="#Symmetry-analysis"><span>Symmetry analysis</span></a></li><li><a class="tocitem" href="#Interactions"><span>Interactions</span></a></li><li><a class="tocitem" href="#System-definition"><span>System definition</span></a></li><li><a class="tocitem" href="#Sampling"><span>Sampling</span></a></li><li><a class="tocitem" href="#Structure-factor-calculations"><span>Structure factor calculations</span></a></li><li><a class="tocitem" href="#Plotting"><span>Plotting</span></a></li><li><a class="tocitem" href="#Integrators"><span>Integrators</span></a></li></ul></li><li><a class="tocitem" href="../structure-factor/">Structure Factor Calculations</a></li><li><a class="tocitem" href="../internals/">Internals</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Library API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Library API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SunnySuite/Sunny.jl/blob/main/docs/src/library.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Library-API"><a class="docs-heading-anchor" href="#Library-API">Library API</a><a id="Library-API-1"></a><a class="docs-heading-anchor-permalink" href="#Library-API" title="Permalink"></a></h1><p>This page describes the public types and functions exported by Sunny. This documentation can be also be accessed using the Julia help system (enter <code>?</code> at the Julia command prompt).</p><p>Typical Sunny usage will involve the following steps:</p><ol><li>Create a <a href="#Sunny.Crystal"><code>Crystal</code></a>, either by providing explicit geometry information or by loading a <code>.cif</code> file.</li><li>Perform symmetry analysis using <a href="#Sunny.print_symmetry_table"><code>print_symmetry_table</code></a>.</li><li>Define a list of <a href="#Interactions">Interactions</a>, i.e., terms to be included in the Hamiltonian.</li><li>Specify information for each site through a <a href="@ref"><code>SiteInfo</code></a> object that specifies, e.g., local spin magnitude and <span>$g$</span>-tensor.</li><li>Assemble a <a href="#Sunny.SpinSystem"><code>SpinSystem</code></a> using the crystal, the interactions, the dimensions of the simulation box (in unit cells), and the site information.</li><li>Perform some flavor of Monte Carlo simulation, which is used to sample equilibrated spin configurations.</li><li>Measure the static or dynamical structure factor. For this, Sunny provides high-level helper functions <a href="#Sunny.dynamic_structure_factor"><code>dynamic_structure_factor</code></a> and <a href="#Sunny.static_structure_factor"><code>static_structure_factor</code></a>. For more documentation, see <a href="#Structure-factor-calculations">Structure factor calculations</a>.</li></ol><h2 id="Crystal-definition"><a class="docs-heading-anchor" href="#Crystal-definition">Crystal definition</a><a id="Crystal-definition-1"></a><a class="docs-heading-anchor-permalink" href="#Crystal-definition" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Sunny.Crystal" href="#Sunny.Crystal"><code>Sunny.Crystal</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Crystal</code></pre><p>A type holding all geometry and symmetry information needed to represent  a three-dimensional crystal.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/Crystal.jl#L65-L70">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.Crystal-Tuple{Any, Any}" href="#Sunny.Crystal-Tuple{Any, Any}"><code>Sunny.Crystal</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Crystal(lat_vecs, positions; types=nothing, symprec=1e-5)</code></pre><p>Constructs a crystal from the complete list of atom positions <code>positions</code>, representing fractions (between 0 and 1) of the lattice vectors <code>lat_vecs</code>. All symmetry information is automatically inferred.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/Crystal.jl#L100-L106">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.Crystal-Tuple{AbstractString}" href="#Sunny.Crystal-Tuple{AbstractString}"><code>Sunny.Crystal</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Crystal(filename::AbstractString; symprec=1e-5)</code></pre><p>Reads the crystal from a <code>.cif</code> file located at the path <code>filename</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/Parsing.jl#L67-L71">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.subcrystal" href="#Sunny.subcrystal"><code>Sunny.subcrystal</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">subcrystal(cryst, types) :: Crystal</code></pre><p>Filters sublattices of a <code>Crystal</code> by atom <code>types</code>, keeping the space group unchanged.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/Crystal.jl#L390-L395">source</a></section><section><div><pre><code class="nohighlight hljs">subcrystal(cryst, classes) :: Crystal</code></pre><p>Filters sublattices of <code>Crystal</code> by equivalence <code>classes</code>, keeping the space group unchanged.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/Crystal.jl#L407-L412">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.nbasis" href="#Sunny.nbasis"><code>Sunny.nbasis</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nbasis(crystal::Crystal)</code></pre><p>Number of basis positions (sublattices) in the unit cell.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/Crystal.jl#L82-L86">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.cell_volume" href="#Sunny.cell_volume"><code>Sunny.cell_volume</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">cell_volume(crystal::Crystal)</code></pre><p>Volume of the crystal unit cell.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/Crystal.jl#L89-L93">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.lattice_vectors" href="#Sunny.lattice_vectors"><code>Sunny.lattice_vectors</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lattice_vectors(a, b, c, α, β, γ)</code></pre><p>Return the lattice vectors, as columns of the <span>$3×3$</span> output matrix, that correspond to the conventional unit cell defined by the lattice constants <span>$(a, b, c)$</span> and the angles <span>$(α, β, γ)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/LatticeUtils.jl#L18-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.lattice_params" href="#Sunny.lattice_params"><code>Sunny.lattice_params</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">lattice_params(lat_vecs::Mat3)</code></pre><p>Compute the lattice parameters <span>$(a, b, c, α, β, γ)$</span> from a set of lattice vectors,  which form the columns of <code>lat_vecs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/LatticeUtils.jl#L3-L8">source</a></section></article><h2 id="Symmetry-analysis"><a class="docs-heading-anchor" href="#Symmetry-analysis">Symmetry analysis</a><a id="Symmetry-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Symmetry-analysis" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Sunny.Bond" href="#Sunny.Bond"><code>Sunny.Bond</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Bond(i, j, n)</code></pre><p>Represents a bond between atom indices <code>i</code> and <code>j</code>. <code>n</code> is a vector of three integers specifying unit cell displacement in terms of lattice vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/Bond.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.displacement" href="#Sunny.displacement"><code>Sunny.displacement</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">displacement(cryst::Crystal, b::Bond)</code></pre><p>The displacement vector <span>$𝐫_j - 𝐫_i$</span> in global coordinates between atoms <code>b.i</code> and <code>b.j</code>, accounting for the integer offsets <code>b.n</code> between unit cells.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/Bond.jl#L40-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.distance" href="#Sunny.distance"><code>Sunny.distance</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">distance(cryst::Crystal, b::Bond)</code></pre><p>The global distance between atoms in bond <code>b</code>. Equivalent to <code>norm(displacement(cryst, b))</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/Bond.jl#L53-L58">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.coordination_number" href="#Sunny.coordination_number"><code>Sunny.coordination_number</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">coordination_number(cryst::Crystal, i::Int, b::Bond)</code></pre><p>Returns the number times that atom <code>i</code> participates in a bond equivalent to <code>b</code>. In other words, the count of bonds that begin at atom <code>i</code> and that are symmetry-equivalent to <code>b</code> or its reverse.</p><p>Defined as <code>length(all_symmetry_related_bonds_for_atom(cryst, i, b))</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/SymmetryAnalysis.jl#L224-L232">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.print_site" href="#Sunny.print_site"><code>Sunny.print_site</code></a> — <span class="docstring-category">Function</span></header><section><div><p>print_site(cryst, i; R=I)</p><p>Print symmetry information for the site <code>i</code>, including allowed g-tensor and allowed anisotropy operator. An optional rotation matrix <code>R</code> can be provided to define the reference frame for expression of the anisotropy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/Printing.jl#L230-L236">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.print_bond" href="#Sunny.print_bond"><code>Sunny.print_bond</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">print_bond(cryst::Crystal, bond::Bond)</code></pre><p>Prints symmetry information for bond <code>bond</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/Printing.jl#L150-L154">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.print_symmetry_table" href="#Sunny.print_symmetry_table"><code>Sunny.print_symmetry_table</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">print_symmetry_table(cryst::Crystal, max_dist)</code></pre><p>Print symmetry information for all equivalence classes of sites and bonds, up to a maximum bond distance of <code>max_dist</code>. Equivalent to calling <code>print_bond(cryst, b)</code> for every bond <code>b</code> in <code>reference_bonds(cryst, max_dist)</code>, where <code>Bond(i, i, [0,0,0])</code> refers to a single site <code>i</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/Printing.jl#L196-L203">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.print_anisotropy_as_stevens" href="#Sunny.print_anisotropy_as_stevens"><code>Sunny.print_anisotropy_as_stevens</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function print_anisotropy_as_stevens(p; N)</code></pre><p>Prints a quantum operator (e.g. a polynomial of the spin operators <code>𝒮</code>) as a linear combination of Stevens operators in the classical limit. The symbol <code>X</code> denotes the spin magnitude squared, |𝒮|^2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/LocalOperators.jl#L294-L300">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.reference_bonds" href="#Sunny.reference_bonds"><code>Sunny.reference_bonds</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">reference_bonds(cryst::Crystal, max_dist)</code></pre><p>Returns a full list of bonds, one for each symmetry equivalence class, up to distance <code>max_dist</code>. The reference bond <code>b</code> for each equivalence class is selected according to a scoring system that prioritizes simplification of the elements in <code>basis_for_symmetry_allowed_couplings(cryst, b)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/SymmetryAnalysis.jl#L160-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.all_symmetry_related_bonds" href="#Sunny.all_symmetry_related_bonds"><code>Sunny.all_symmetry_related_bonds</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">all_symmetry_related_bonds(cryst::Crystal, b::Bond)</code></pre><p>Returns a list of all bonds that are symmetry-equivalent to bond <code>b</code> or its reverse.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/SymmetryAnalysis.jl#L210-L215">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.all_symmetry_related_bonds_for_atom" href="#Sunny.all_symmetry_related_bonds_for_atom"><code>Sunny.all_symmetry_related_bonds_for_atom</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">all_symmetry_related_bonds_for_atom(cryst::Crystal, i::Int, b::Bond)</code></pre><p>Returns a list of all bonds that start at atom <code>i</code>, and that are symmetry equivalent to bond <code>b</code> or its reverse.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/SymmetryAnalysis.jl#L193-L198">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.all_symmetry_related_couplings" href="#Sunny.all_symmetry_related_couplings"><code>Sunny.all_symmetry_related_couplings</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">all_symmetry_related_couplings(cryst::Crystal, b::Bond, J)</code></pre><p>Given a reference bond <code>b</code> and coupling matrix <code>J</code> on that bond, return a list of symmetry-equivalent bonds and a corresponding list of symmetry-transformed coupling matrices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/AllowedCouplings.jl#L284-L290">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.all_symmetry_related_couplings_for_atom" href="#Sunny.all_symmetry_related_couplings_for_atom"><code>Sunny.all_symmetry_related_couplings_for_atom</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">all_symmetry_related_couplings_for_atom(cryst::Crystal, i::Int, b::Bond, J)</code></pre><p>Given a reference bond <code>b</code> and coupling matrix <code>J</code> on that bond, return a list of symmetry-equivalent bonds (constrained to start from atom <code>i</code>), and a corresponding list of symmetry-transformed coupling matrices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Symmetry/AllowedCouplings.jl#L260-L266">source</a></section></article><h2 id="Interactions"><a class="docs-heading-anchor" href="#Interactions">Interactions</a><a id="Interactions-1"></a><a class="docs-heading-anchor-permalink" href="#Interactions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Sunny.anisotropy" href="#Sunny.anisotropy"><code>Sunny.anisotropy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">anisotropy(op, site)</code></pre><p>Creates a general anisotropy specified as a polynomial of spin operators <code>𝒮</code> or Stevens operators <code>𝒪</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Interactions.jl#L175-L180">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.heisenberg" href="#Sunny.heisenberg"><code>Sunny.heisenberg</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">heisenberg(J, bond::Bond, label::String=&quot;Heisen&quot;)</code></pre><p>Creates a Heisenberg interaction</p><p class="math-container">\[    J ∑_{⟨ij⟩} 𝐒_i ⋅ 𝐒_j\]</p><p>where <span>$⟨ij⟩$</span> runs over all bonds symmetry equivalent to <code>bond</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Interactions.jl#L138-L146">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.dm_interaction" href="#Sunny.dm_interaction"><code>Sunny.dm_interaction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">dm_interaction(DMvec, bond::Bond, label::String=&quot;DMInt&quot;)</code></pre><p>Creates a DM Interaction</p><p class="math-container">\[    ∑_{⟨ij⟩} 𝐃^{(ij)} ⋅ (𝐒_i × 𝐒_j)\]</p><p>where <span>$⟨ij⟩$</span> runs over all bonds symmetry equivalent to <code>bond</code>, and <span>$𝐃^{(ij)}$</span> is the covariant transformation of the DM pseudo-vector <code>DMvec</code> appropriate for the bond <span>$⟨ij⟩$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Interactions.jl#L150-L160">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.exchange" href="#Sunny.exchange"><code>Sunny.exchange</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">exchange(J, bond::Bond, label=&quot;Exchange&quot;)</code></pre><p>Creates a quadratic interaction,</p><p class="math-container">\[    ∑_{⟨ij⟩} 𝐒_i^T J^{(ij)} 𝐒_j\]</p><p>where <span>$⟨ij⟩$</span> runs over all bonds (not doubly counted) that are symmetry equivalent to <code>bond</code>. The <span>$3 × 3$</span> interaction matrix <span>$J^{(ij)}$</span> is the covariant transformation of <code>J</code> appropriate for the bond <span>$⟨ij⟩$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Interactions.jl#L120-L132">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.external_field" href="#Sunny.external_field"><code>Sunny.external_field</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">external_field(B::Vec3)</code></pre><p>Adds an external field <span>$𝐁$</span> with Zeeman coupling,</p><p class="math-container">\[    -∑_i 𝐁 ⋅ 𝐌_i.\]</p><p>The magnetic moments are <span>$𝐌_i = μ_B g 𝐒_i$</span> where <span>$g$</span> is the g-factor or g-tensor, and the spin magnitude <span>$|𝐒_i|$</span> is typically a multiple of 1/2. The Bohr magneton <span>$μ_B$</span> is a physical constant, with numerical value determined by the unit system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Interactions.jl#L280-L293">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.dipole_dipole" href="#Sunny.dipole_dipole"><code>Sunny.dipole_dipole</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">dipole_dipole(; extent::Int=4, η::Float64=0.5)</code></pre><p>Includes long-range dipole-dipole interactions,</p><p class="math-container">\[    -(μ₀/4π) ∑_{⟨ij⟩}  (3 (𝐌_j⋅𝐫̂_{ij})(𝐌_i⋅𝐫̂_{ij}) - 𝐌_i⋅𝐌_j) / |𝐫_{ij}|^3\]</p><p>where the sum is over all pairs of spins (singly counted), including periodic images, regularized using the Ewald summation convention. The magnetic moments are <span>$𝐌_i = μ_B g 𝐒_i$</span> where <span>$g$</span> is the g-factor or g-tensor, and the spin magnitude <span>$|𝐒_i|$</span> is typically a multiple of 1/2. The Bohr magneton <span>$μ_B$</span> and vacuum permeability <span>$μ_0$</span> are physical constants, with numerical values determined by the unit system.</p><p><code>extent</code> controls the number of periodic copies of the unit cell summed over in the Ewald summation (higher is more accurate, but higher creation-time cost), while <code>η</code> controls the direct/reciprocal-space tradeoff in the Ewald summation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Interactions.jl#L254-L273">source</a></section></article><h2 id="System-definition"><a class="docs-heading-anchor" href="#System-definition">System definition</a><a id="System-definition-1"></a><a class="docs-heading-anchor-permalink" href="#System-definition" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Sunny.SpinSystem" href="#Sunny.SpinSystem"><code>Sunny.SpinSystem</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Defines a collection of spins, as well as the Hamiltonian they interact under.  This is the main type to interface with most of the package.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Systems.jl#L3-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.SpinSystem-Tuple{Crystal, Vector{&lt;:Sunny.AbstractInteraction}, Any, Vector{SiteInfo}}" href="#Sunny.SpinSystem-Tuple{Crystal, Vector{&lt;:Sunny.AbstractInteraction}, Any, Vector{SiteInfo}}"><code>Sunny.SpinSystem</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SpinSystem(crystal::Crystal, ints::Vector{&lt;:AbstractInteraction}, latsize, site_infos::Vector{SiteInfo}=[];
           μB, μ0)</code></pre><p>Construct a <code>SpinSystem</code> with spins of magnitude <code>S</code> residing on the lattice sites  of a given <code>crystal</code>, interactions given by <code>ints</code>, and the number of unit cells along  each lattice vector specified by <code>latsize</code>. Initialized to all spins pointing along  the <span>$+𝐳̂$</span> direction. μB and μ0 set the Bohr magneton and vacuum permeability. By  default, these are set so that the unit system is (meV, T, Å).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Systems.jl#L175-L184">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SiteInfo</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="Random.rand!-Union{Tuple{SpinSystem{N}}, Tuple{N}} where N" href="#Random.rand!-Union{Tuple{SpinSystem{N}}, Tuple{N}} where N"><code>Random.rand!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rand!(sys::SpinSystem{N}) where N</code></pre><p>Randomly sample all spins from CP<span>$^{N-1}$</span>, i.e., from the space of normalized <span>$N$</span>-component complex coherent states. In the special case of <span>$N=0$</span>, randomly sample spin dipoles.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Systems.jl#L214-L220">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.randflips!" href="#Sunny.randflips!"><code>Sunny.randflips!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">randflips!(sys::SpinSystem{N}) where N</code></pre><p>Randomly &quot;flip&quot; every spin with probability 1/2. In the dipole case (<span>$N=0$</span>), a flip corresponds to sign reversal, <span>$𝐒_i → -𝐒_i$</span>. In the general case (<span>$N&gt;0$</span>), flipping the coherent state means complex conjugation followed by rotation about the <span>$y$</span>-axis by π/2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Systems.jl#L242-L249">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.energy" href="#Sunny.energy"><code>Sunny.energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">energy(sys::SpinSystem)</code></pre><p>Computes the energy of the system under <code>sys.hamiltonian</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Systems.jl#L271-L275">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.field" href="#Sunny.field"><code>Sunny.field</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Calculates the local field, <code>Bᵢ</code>, for a single site, <code>i</code>:</p><p><span>$𝐁_i = -∇_{𝐬_i} ℋ$</span>.</p><p>This is useful for some sampling methods.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Hamiltonian.jl#L230-L236">source</a></section><section><div><pre><code class="nohighlight hljs">field(sys::SpinSystem)</code></pre><p>Compute the local field B at each site of the system under <code>sys.hamiltonian</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Systems.jl#L291-L296">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.field!" href="#Sunny.field!"><code>Sunny.field!</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Updates <code>B</code> in-place to hold the local field on <code>spins</code> under <code>ℋ</code>, defined as:</p><p><span>$𝐁_i = -∇_{𝐬_i} ℋ$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Hamiltonian.jl#L200-L205">source</a></section><section><div><pre><code class="nohighlight hljs">field!(B::Array{Vec3}, sys::SpinSystem)</code></pre><p>Updates B in-place to contain the local field at each site in the system under <code>sys.hamiltonian</code>. The &quot;local field&quot; is defined as</p><p><span>$𝐁_i = -∇_{𝐬_i} ℋ / S_i$</span></p><p>with <span>$𝐬_i$</span> the unit-vector variable at site i, and <span>$S_i$</span> is the magnitude of the associated spin.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Systems.jl#L278-L288">source</a></section></article><h2 id="Sampling"><a class="docs-heading-anchor" href="#Sampling">Sampling</a><a id="Sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Sunny.LangevinSampler" href="#Sunny.LangevinSampler"><code>Sunny.LangevinSampler</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">LangevinSampler(sys::SpinSystem, kT::Float64, α::Float64, Δt::Float64, nsteps::Int)</code></pre><p>Creates a <code>LangevinSampler</code> which samples the spin system&#39;s Hamiltonian using Langevin  dynamics at a temperature <code>kT</code>, damping coefficient <code>α</code>, and producing a new sample  by integrating with <code>nsteps</code> timesteps of size <code>Δt</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Integrators.jl#L452-L458">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.MetropolisSampler" href="#Sunny.MetropolisSampler"><code>Sunny.MetropolisSampler</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MetropolisSampler(sys::SpinSystem, kT::Float64, nsweeps::Int)</code></pre><p>A sampler which performs the standard Metropolis Monte Carlo algorithm to sample  a <code>SpinSystem</code> at the requested temperature.</p><p>Each single-spin update attempts to completely randomize the spin. One call to  <code>sample!</code> will attempt to flip each spin <code>nsweeps</code> times.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Metropolis.jl#L66-L74">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.IsingSampler" href="#Sunny.IsingSampler"><code>Sunny.IsingSampler</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">IsingSampler(sys::SpinSystem, kT::Float64, nsweeps::Int)</code></pre><p>A sampler which performs the standard Metropolis Monte Carlo algorithm to sample a <code>SpinSystem</code> at the requested temperature.</p><p>This version differs from <code>MetropolisSampler</code> in that each single-spin update only attempts to completely flip the spin. One call to <code>sample!</code> will attempt to flip each spin <code>nsweeps</code> times.</p><p>Before constructing, be sure that your <code>SpinSystem</code> is initialized so that each spin points along its &quot;Ising-like&quot; axis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Metropolis.jl#L87-L99">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.set_temp!" href="#Sunny.set_temp!"><code>Sunny.set_temp!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_temp!(sampler, kT)</code></pre><p>Changes the temperature of the sampler to <code>kT</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Metropolis.jl#L126-L130">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.sample!" href="#Sunny.sample!"><code>Sunny.sample!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sample!(sampler)</code></pre><p>Samples <code>sampler.sys</code> to a new state, under the Boltzmann distribution  as defined by <code>sampler.sys.hamiltonian</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Metropolis.jl#L232-L237">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.thermalize!" href="#Sunny.thermalize!"><code>Sunny.thermalize!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">thermalize!(sampler, num_samples)</code></pre><p><code>sample!</code> a sampler a given number of times.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Metropolis.jl#L24-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.anneal!" href="#Sunny.anneal!"><code>Sunny.anneal!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">anneal!(sampler, temp_schedule, step_schedule)</code></pre><p><code>sample!</code> a sampler at a series of temperatures, staying at each temperature   for the number of steps in <code>step_schedule</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Metropolis.jl#L36-L41">source</a></section><section><div><pre><code class="nohighlight hljs">anneal!(sampler, temp_function, num_samples)</code></pre><p><code>sample!</code> a sampler <code>num_samples</code> times, with the sample at timestep <code>n</code>  drawn at a temperature <code>temp_function(n)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Metropolis.jl#L51-L56">source</a></section></article><h2 id="Structure-factor-calculations"><a class="docs-heading-anchor" href="#Structure-factor-calculations">Structure factor calculations</a><a id="Structure-factor-calculations-1"></a><a class="docs-heading-anchor-permalink" href="#Structure-factor-calculations" title="Permalink"></a></h2><p>For extended details on what these functions compute, and how they do it, see the page <a href="../structure-factor/#Structure-Factor-Calculations">Structure Factor Calculations</a></p><article class="docstring"><header><a class="docstring-binding" id="Sunny.StructureFactor" href="#Sunny.StructureFactor"><code>Sunny.StructureFactor</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">StructureFactor</code></pre><p>Type responsible for computing and updating the static/dynamic structure factor averaged across multiple spin configurations. In general, the user should not create a StructureFactor directly, but instead use the interfaces <code>static_structure_factor</code> and <code>dynamic_structure_factor</code> to have Sunny build one for you.</p><p>Note that the initial <code>sys</code> provided does <em>not</em> enter the structure factor, it is purely used to determine the size of various results.</p><p>The full dynamic structure factor is <span>$𝒮^{αβ}_{jk}(𝐪, ω) = ⟨M^α_j(𝐪, ω) M^β_k(𝐪, ω)^∗⟩$</span>, which is an array of shape <code>[3, 3, Q1, Q2, Q3, B, B, T]</code> where <code>B = nbasis(sys.lattice)</code>, <code>Qi = max(1, bz_size_i * L_i)</code> and <code>T = num_omegas</code>. By default, <code>bz_size=ones(d)</code>.</p><p>Indexing the <code>.sfactor</code> attribute at <code>(α, β, q1, q2, q3, j, k, w)</code> gives <span>$𝒮^{αβ}_{jk}(𝐪, ω)$</span> at <code>𝐪 = q1 * 𝐛_1 + q2 * 𝐛_2 + q3 * 𝐛_3</code>, and <code>ω = ω_max * w / T</code>, where <code>𝐛_1, 𝐛_2, 𝐛_3</code> are the reciprocal lattice vectors of the system supercell.</p><p>Allowed values for the <code>qi</code> indices lie in <code>-div(Qi, 2):div(Qi, 2, RoundUp)</code>, and allowed  values for the <code>w</code> index lie in <code>0:T-1</code>.</p><p><code>meas_period</code> determines how many steps to skip between measurements of dynamical trajectories and is set to 1 by default. It determines the maximum resolved frequency, which is 2π/(meas<em>rate*dt). The total number of resolved frequencies is set with `num</em>omegas<code>(the number of spin snapshots measured during dynamics). By default,</code>num<em>omegas=1<code>, and the static structure factor is computed. Note also that that</code>meas</em>rate` has no meaning for a static structure factor and is ignored.</p><p>Setting <code>reduce_basis</code> performs the phase-weighted sums over the basis/sublattice indices, resulting in a size <code>[3, 3, Q1, Q2, Q3, T]</code> array.</p><p>Setting <code>dipole_factor</code> applies the dipole form factor, further reducing the array to size <code>[Q1, Q2, Q3, T]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/StructureFactors.jl#L14-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.update!" href="#Sunny.update!"><code>Sunny.update!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">update!(sf::StructureFactor, sys::SpinSystem)</code></pre><p>Accumulates a contribution to the dynamic structure factor from the spin configuration currently in <code>sys</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/StructureFactors.jl#L182-L187">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.apply_dipole_factor" href="#Sunny.apply_dipole_factor"><code>Sunny.apply_dipole_factor</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">apply_dipole_factor(sf::StructureFactor) :: StructureFactor</code></pre><p>Apply the neutron dipole factor to a dynamic structure factor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/StructureFactors.jl#L243-L247">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.dynamic_structure_factor" href="#Sunny.dynamic_structure_factor"><code>Sunny.dynamic_structure_factor</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">dynamic_structure_factor(sys::SpinSystem, sampler::S;
    nsamples::Int=10, thermalize::Int=10, dt::Float64=0.01, num_omegas::Int=100, omega_max=nothing, 
    bz_size=(1,1,1), reduce_basis::Bool=true, dipole_factor::Bool=false, verbose::Bool=false)</code></pre><p>Measures the full dynamic structure factor tensor of a spin system, for the requested range of 𝐪-space and range of frequencies ω. Returns <span>$𝒮^{αβ}(𝐪, ω) = ⟨S^α(𝐪, ω) S^β(𝐪, ω)^∗⟩$</span>, which is an array of shape <code>[3, 3, Q1, ..., Qd, T]</code> where <code>Qi = max(1, bz_size_i * L_i)</code> and <code>T = num_omegas</code>. By default, <code>bz_size=ones(d)</code>.</p><p>Setting <code>reduce_basis=false</code> makes it so that the basis/sublattice indices are not phase-weighted and summed over, making the shape of the result <code>[3, 3, B, B, Q1, ..., Qd, T]</code> where <code>B = nbasis(sys)</code> is the number of basis sites in the unit cell.</p><p><code>nsamples</code> sets the number of thermodynamic samples to measure and average  across from <code>sampler</code>. <code>dt</code> sets the integrator timestep during dynamics,  and <code>meas_period</code> sets how often snapshots are recorded during dynamics. <code>num_omegas</code>  sets the total number snapshots taken. The sampler is thermalized by sampling  <code>thermalize</code> times before any measurements are made.</p><p>The maximum frequency sampled is <code>ωmax = 2π / (dt * meas_period)</code>, and the frequency resolution  is set by <code>num_omegas</code> (the number of spin snapshots measured during dynamics). <code>num_omegas</code> defaults  to 100. Note that <code>meas_period</code> is determined automatically by Sunny based on what the user  assigns to <code>dt</code> and <code>omega_max</code>. If no value is given to <code>omega_max</code>, <code>meas_period</code> is set to 1.</p><p>Indexing the result at <code>(α, β, q1, ..., qd, w)</code> gives <span>$S^{αβ}(𝐪, ω)$</span> at     <code>𝐪 = q1 * a⃰ + q2 * b⃰ + q3 * c⃰</code>, and <code>ω = maxω * w / T</code>, where <code>a⃰, b⃰, c⃰</code>     are the reciprocal lattice vectors of the system supercell.</p><p>Allowed values for the <code>qi</code> indices lie in <code>-div(Qi, 2):div(Qi, 2, RoundUp)</code>, and allowed  values for the <code>w</code> index lie in <code>0:T-1</code>.</p><p>If you you would like the form factor to be applied to the resulting structure factor, set the parameter <code>ff_elem</code> to the desired element, e.g. <code>ff_elem=&quot;Fe2&quot;</code>. For a list of the available ions and their names, see https://www.ill.eu/sites/ccsl/ffacts/ffachtml.html .</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/StructureFactors.jl#L279-L314">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.static_structure_factor" href="#Sunny.static_structure_factor"><code>Sunny.static_structure_factor</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">static_structure_factor(sys, sampler; nsamples, bz_size, thermalize, verbose)</code></pre><p>Measures the static structure factor tensor of a spin system, for the requested range of 𝐪-space. Returns <span>$𝒮^{αβ}(𝐪) = ⟨S^α(𝐪) S^β(𝐪)^∗⟩$</span>, which is an array of shape <code>[3, 3, Q1, ..., Qd]</code> where <code>Qi = max(1, bz_size_i * L_i)</code>. By default, <code>bz_size=ones(d)</code>.</p><p><code>nsamples</code> sets the number of thermodynamic samples to measure and average  across from <code>sampler</code>. <code>dt</code> sets the integrator timestep during dynamics.  The sampler is thermalized by sampling <code>thermalize</code> times before any measurements are made.</p><p>Indexing the result at <code>(α, β, q1, ..., qd)</code> gives <span>$𝒮^{αβ}(𝐪)$</span> at     <code>𝐪 = q1 * a⃰ + q2 * b⃰ + q3 * c⃰</code>, where <code>a⃰, b⃰, c⃰</code>     are the reciprocal lattice vectors of the system supercell.</p><p>Allowed values for the <code>qi</code> indices lie in <code>-div(Qi, 2):div(Qi, 2, RoundUp)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/StructureFactors.jl#L354-L371">source</a></section></article><h2 id="Plotting"><a class="docs-heading-anchor" href="#Plotting">Plotting</a><a id="Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting" title="Permalink"></a></h2><p>To reduce package load times, Sunny plotting functions are initially hidden, and only become available when the user explicitly executes &quot;<code>using GLMakie</code>&quot;. It is a good idea to check that the <a href="https://github.com/JuliaPlots/Makie.jl/tree/master/GLMakie">GLMakie</a> installation is working correctly (execute &quot;<code>] test GLMakie</code>&quot; from the Julia REPL).</p><article class="docstring"><header><a class="docstring-binding" id="Sunny.plot_lattice" href="#Sunny.plot_lattice"><code>Sunny.plot_lattice</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_lattice(crystal, latsize=(3,3,3); kwargs...)</code></pre><p>Plots a crystal lattice with <code>latsize</code> unit cells along each lattice vector. Other keyword arguments are:</p><p>colors=:Set1_9, markersize=20, linecolor=:grey, linewidth=1.0, kwargs...</p><p><strong>Arguments</strong></p><ul><li><code>linecolor=:grey</code>: Sets the colors on the unit cell guide lines</li><li><code>linewidth=1.0</code>  : Sets the width of the unit cell guide lines</li><li><code>markersize=20</code>  : Sets the size of the atomic sites</li><li><code>colors=:Set1_9</code> : Sets the colors used for the atomic sites</li></ul><p>Additional keyword arguments are given to <code>GLMakie.scatter!</code> which draws the points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Plotting.jl#L34-L49">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.plot_spins" href="#Sunny.plot_spins"><code>Sunny.plot_spins</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_spins(sys::SpinSystem; linecolor=:grey, arrowcolor=:red, linewidth=0.1,
                            arrowsize=0.3, arrowlength=1.0, kwargs...)</code></pre><p>Plot the spin configuration defined by <code>sys</code>. <code>kwargs</code> are passed to <code>GLMakie.arrows</code>.        </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Plotting.jl#L242-L247">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.plot_bonds" href="#Sunny.plot_bonds"><code>Sunny.plot_bonds</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_bonds(cryst::Crystal, ints, latsize=(3,3,3), site_infos=SiteInfo[]; kwargs...)</code></pre><p>Plot a list of pair interactions defined on a <code>Crystal</code>. <code>latsize</code> sets how many unit cells are plotted, and <code>kwargs</code> are passed to to <code>plot_lattice!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Plotting.jl#L109-L114">source</a></section><section><div><pre><code class="nohighlight hljs">plot_bonds(sys::SpinSystem; kwargs...)</code></pre><p>Plot all pair interactions appearing in <code>sys.hamiltonian</code>, on the underlying crystal lattice. <code>kwargs</code> are passed to <code>plot_lattice!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Plotting.jl#L126-L131">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.plot_all_bonds" href="#Sunny.plot_all_bonds"><code>Sunny.plot_all_bonds</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plot_all_bonds(crystal::Crystal, max_dist, latsize=(3,3,3); kwargs...)</code></pre><p>Plot all bond equivalency classes present in <code>crystal</code> up to a maximum bond length of <code>max_dist</code>. <code>latsize</code> controls how many unit cells are plotted along each axis. <code>kwargs</code> are passed to <code>plot_bonds</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Plotting.jl#L138-L144">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.anim_integration" href="#Sunny.anim_integration"><code>Sunny.anim_integration</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">anim_integration(sys, fname, steps_per_frame, Δt, nframes; kwargs...)</code></pre><p>Produce an animation of constant-energy Landau-Lifshitz dynamics of the given <code>sys</code>.</p><p><strong>Arguments:</strong></p><ul><li><code>sys::SpinSystem</code>: The spin system to integrate.</li><li><code>fname::String</code>: The path to save the animation to.</li><li><code>steps_per_frame::Int</code>: The number of integration steps to take per frame.</li><li><code>Δt::Float64</code>: The integration timestep size.</li><li><code>nframes::Int</code>: The number of frames to produce in the animation.</li></ul><p>Other keyword arguments are passed to <code>GLMakie.arrows</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Plotting.jl#L252-L264">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.live_integration" href="#Sunny.live_integration"><code>Sunny.live_integration</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">live_integration(sys, steps_per_frame, Δt; kwargs...)</code></pre><p>Performs endless live constant-energy Landau-Lifshitz integration in an interactive window.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Plotting.jl#L292-L297">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.live_langevin_integration" href="#Sunny.live_langevin_integration"><code>Sunny.live_langevin_integration</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">live_langevin_integration(sys, steps_per_frame, Δt, kT; α=0.1, kwargs...)</code></pre><p>Performs endless live Langevin Landau-Lifshitz integration in an interactive window.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Plotting.jl#L325-L330">source</a></section></article><h2 id="Integrators"><a class="docs-heading-anchor" href="#Integrators">Integrators</a><a id="Integrators-1"></a><a class="docs-heading-anchor-permalink" href="#Integrators" title="Permalink"></a></h2><p>These functions are not intended to be used by typical users, who instead should instead perform dynamics either using <a href="#Sunny.LangevinSampler"><code>LangevinSampler</code></a> or implicitly in <a href="../structure-factor/#Structure-Factor-Calculations">Structure Factor Calculations</a>. However, advanced users and developers may want direct access to an interface to perform dynamics integrations.</p><article class="docstring"><header><a class="docstring-binding" id="Sunny.HeunP" href="#Sunny.HeunP"><code>Sunny.HeunP</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HeunP(sys::SpinSystem)</code></pre><p>Integrates Landau-Lifshitz spin dynamics using the Heun method, with a final projection step that exactly constrains |S|=1. The method is locally second order accurate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Integrators.jl#L13-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.LangevinHeunP" href="#Sunny.LangevinHeunP"><code>Sunny.LangevinHeunP</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LangevinHeunP(sys, kT, α)</code></pre><p>Implements Langevin dynamics on <code>sys</code> targeting a temperature <code>kT</code>, with a damping coefficient <code>α</code>. Provided <code>α</code> should not be normalized by the spin magnitude – this is done internally.</p><p>Uses the 2nd-order Heun + projection scheme.&quot;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Integrators.jl#L33-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.SphericalMidpoint" href="#Sunny.SphericalMidpoint"><code>Sunny.SphericalMidpoint</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SphericalMidpoint(sys::SpinSystem; atol=1e-12)</code></pre><p>Integrates Landau-Lifshitz spin dynamics using the spherical-midpoint integrator, which is symplectic and implicit. Each step is converged to absolute tolerance <code>atol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Integrators.jl#L62-L68">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Sunny.evolve!" href="#Sunny.evolve!"><code>Sunny.evolve!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">evolve!(integrator, Δt)</code></pre><p>Performs a single integrator timestep of size Δt.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SunnySuite/Sunny.jl/blob/e3b66c8c8f540e3b7aa40c9677f963e78c371f70/src/Integrators.jl#L195-L199">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../quick-start/">« Quick Start</a><a class="docs-footer-nextpage" href="../structure-factor/">Structure Factor Calculations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 26 October 2022 18:28">Wednesday 26 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
